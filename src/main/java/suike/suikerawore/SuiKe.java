package suike.suikerawore;

import suike.suikerawore.item.ItemBase;
import suike.suikerawore.item.rawOreTabs;
import suike.suikerawore.recipe.Recipe;
import suike.suikerawore.expand.Expand;
import suike.suikerawore.expand.Examine;
import suike.suikerawore.config.Config;
import suike.suikerawore.proxy.CommonProxy;
import suike.suikerawore.oredictionary.OreDict;

import net.minecraft.client.Minecraft;

import net.minecraftforge.fml.common.Mod;
import net.minecraftforge.fml.common.Mod.Instance;
import net.minecraftforge.fml.common.Mod.EventHandler;
import net.minecraftforge.fml.common.SidedProxy;
import net.minecraftforge.fml.common.event.FMLPreInitializationEvent;
import net.minecraftforge.fml.common.event.FMLPostInitializationEvent;
import net.minecraftforge.fml.common.FMLCommonHandler;
import suike.suikerawore.suikerawore.Tags;

@Mod(modid = Tags.MOD_ID, useMetadata = true, acceptedMinecraftVersions = "[1.12,1.13)", version = Tags.VERSION)
public class SuiKe {

    public static final String MODID = Tags.MOD_ID;
    public static final String CLIENT_PROXY = "suike.suikerawore.proxy.ClientProxy";
    public static final String COMMON_PROXY = "suike.suikerawore.proxy.CommonProxy";

    public static boolean server;
    public static boolean isZhCn;

    @Instance
    public static SuiKe instance;

    @SidedProxy(clientSide = SuiKe.CLIENT_PROXY, serverSide = COMMON_PROXY)
    public static CommonProxy proxy;

    //@Mod.EventHandler
    //public void Construction(FMLConstructionEvent event) {}

    @Mod.EventHandler
    public static void PreInit(FMLPreInitializationEvent event) {
        server = FMLCommonHandler.instance().getSide().isServer();
        if (FMLCommonHandler.instance().getSide().isClient()) {
        //检查是否是服务器
            isZhCn = Minecraft.getMinecraft().getLanguageManager().getCurrentLanguage().getLanguageCode().equals("zh_cn");
            isModDescription(event);
        }

        /*读取配置文件*/Config.config(event);

        /*检查是否拥有联动模组*/Examine.examine();
    }

    //@EventHandler
    //public static void Init(FMLInitializationEvent event) {}

    @EventHandler
    public static void PostInit(FMLPostInitializationEvent event) {
        /*矿词*/OreDict.oreDict();

        /*联动*/Expand.expand();

        /*配方*/Recipe.register();

        /*隐藏不需要的方块*/ItemBase.removeItem();

        if (!server) {
            /*创建物品栏*/rawOreTabs.Inventory();
        }
    }

    //@EventHandler
    //public static void LoadComp(FMLLoadCompleteEvent event) {}

    private static void isModDescription(FMLPreInitializationEvent event) {
        event.getModMetadata().autogenerated = false;
        event.getModMetadata().name = "§e" + "1.12.2的粗矿";
        event.getModMetadata().url = "";
        event.getModMetadata().updateUrl = "";
        event.getModMetadata().logoFile = "assets/suikerawore/textures/gui/ico.png";

        if (SuiKe.isZhCn) {
            event.getModMetadata().name = "§e1.12.2的粗矿";
            event.getModMetadata().credits = "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§d模组作者: sui_ke" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§3感谢\"MC百科\"和所有的百科编辑员;" + "\n"
                    + "§5感谢ChatGPT;" + "\n"
                    + "§e感谢:" + "\n"
                    + "§e - 御影; Noble; 镜野七罪ご" + "\n"
                    + "§c发现的严重漏洞" + "   §r- 按提交顺序" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§e相关链接:" + "\n"
                    + "§3MC百科: https://www.mcmod.cn/class/14517.html" + "\n"
                    + "§aModrinth: https://modrinth.com/mod/rawore_on_1.12.2" + "\n"
                    + "§6CurseForge: https://www.curseforge.com/minecraft/mc-mods/rawore-on-1-12-2" + "\n"
                    + "§a更新日志: https://modrinth.com/mod/rawore_on_1.12.2/changelog" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§c本模组只发布在 \"MC百科\" , \"curseforge\" 和 \"Modrinth\" ," + "\n"
                    + "§c其他网站上的文件出问题后果自负!" + "\n"
                    + "--------------------------------------------------" + "\n";
        } else {
            event.getModMetadata().name = "§erawOre_on_1.12.2";
            event.getModMetadata().credits = "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§dMod author: sui_ke" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§3Thanks to MC百科 and all the MC百科 editors;" + "\n"
                    + "§5Thanks to ChatGPT;" + "\n"
                    + "§eThanks:" + "\n"
                    + "§e - 御影; Noble; 镜野七罪ご" + "\n"
                    + "§cDiscovered critical bugs" + "   §r- In order of submission" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§eRelated links:" + "\n"
                    + "§3MC百科: https://www.mcmod.cn/class/14517.html" + "\n"
                    + "§aModrinth: https://modrinth.com/mod/rawore_on_1.12.2" + "\n"
                    + "§6CurseForge: https://www.curseforge.com/minecraft/mc-mods/rawore-on-1-12-2" + "\n"
                    + "§aChangelog: https://modrinth.com/mod/rawore_on_1.12.2/changelog" + "\n"
                    + "--------------------------------------------------" + "\n"
                    + "§cThis mod is only released on \"MC百科\" , \"curseforge\" and \"Modrinth\"," + "\n"
                    + "§cFiles on other websites are not necessarily safe!" + "\n"
                    + "§cIf something goes wrong, you will be at your own risk!" + "\n"
                    + "--------------------------------------------------" + "\n";
        }
    }
}